<!DOCTYPE html>
<html>
<head>
  <title>Upload Report - MedSeal</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
  <h2>Upload Report</h2>

  <form id="uploadForm" enctype="multipart/form-data">
    <input type="file" id="report" name="report" required>
    <button type="submit">Upload & Seal Report</button>
    <a href="/dashboard" class="btn">BACK</a>
  </form>

  <p id="statusText"></p>
</div>

<script>
const form = document.getElementById("uploadForm");
const statusText = document.getElementById("statusText");

form.addEventListener("submit", async e => {
  e.preventDefault();
  const fileInput = document.getElementById("report");
  if (!fileInput.files[0]) return alert("Select a file first!");

  const formData = new FormData();
  formData.append("report", fileInput.files[0]);

  const res = await fetch("/upload", { method: "POST", body: formData });
  const data = await res.json();

  if (data.status) {
    statusText.innerHTML = `<p Class="written"><b>${data.status}</b><br>File: ${data.filename}<br>Uploaded At: ${data.uploaded_at} </p><div class="hash-box">
    <div class="hash-label">Hash</div>
    <div class="hash-value">${data.hash}</div>
</div>
`;
  } else {
    statusText.innerText = "‚ùå Error uploading file";
  }
});
</script>
</body>
</html>